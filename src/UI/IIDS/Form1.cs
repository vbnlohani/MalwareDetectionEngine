using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace IIDS
{
    public partial class Form1 : Form
    {
        

        public Form1()
        {
            InitializeComponent();
            bunifuGradientPanel4.Hide();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        private void Form1_Resize(object sender, EventArgs e)
        {
            if (WindowState == FormWindowState.Minimized) { this.Hide(); }
        }

        private void button2_Click(object sender, EventArgs e)
        {

            this.WindowState = FormWindowState.Minimized;
        }

        private void label1_Click(object sender, EventArgs e)
        {

        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private void bunifuFlatButton3_Click(object sender, EventArgs e)
        {
            bunifuGradientPanel5.Show();
           bunifuGradientPanel6.Hide();
           // bunifuGradientPanel3.Hide();
            
           
        }

        private void bunifuFlatButton2_Click(object sender, EventArgs e)
        {
            openFileDialog1.Title = "Please Select a File";


            openFileDialog1.InitialDirectory = "C:\\VM";


            openFileDialog1.ShowDialog();

            textBox1.Text = openFileDialog1.FileName;
        }

        private void label2_Click(object sender, EventArgs e)
        {

        }

        private void bunifuFlatButton1_Click(object sender, EventArgs e)
        {
            //SidePanel.Height = button2.Height;
            // SidePanel.Top = button2.Top;
            bunifuGradientPanel5.Hide();
            bunifuGradientPanel4.Show();
            
            //  Form2 frm = new Form2();
            //frm.Show();

        }

        private void button3_Click(object sender, EventArgs e)
        {
            
            bunifuGradientPanel3.Show();
            bunifuGradientPanel4.Hide();
        }

        private void button6_Click(object sender, EventArgs e)
        {
            openFileDialog1.Title = "Please Select a File";


        openFileDialog1.InitialDirectory = "C:";


            openFileDialog1.ShowDialog();

            textBox1.Text = openFileDialog1.FileName;
            

        }

        private void openFileDialog1_FileOk(object sender, CancelEventArgs e) 
        {
            
        }

        private void label3_Click(object sender, EventArgs e)
        {

        }

        private void button6_Click_1(object sender, EventArgs e)
        {
            openFileDialog1.Title = "Please Select a File";


            openFileDialog1.InitialDirectory = "C:\\IIDS\\IIDS\\Dynamic";


            openFileDialog1.ShowDialog();

            textBox1.Text = openFileDialog1.FileName;
        }

        private void button5_Click(object sender, EventArgs e)
        {

            ProcessStartInfo startInfo = new ProcessStartInfo();
            startInfo.FileName = "C:\\IIDS\\IIDS\\Dynamic\\Inject_process.exe";
            startInfo.Arguments = "hook "+openFileDialog1.FileName+" C:\\IIDS\\IIDS\\Dynamic\\NewDll.dll";
            Process.Start(startInfo);
            



            /* System.Diagnostics.Process proc = new System.Diagnostics.Process();
             proc.EnableRaisingEvents = false;
             proc.StartInfo.FileName = "winword";
             proc.StartInfo.Arguments = "C:\\Dotnetstuff\\TestWordDoc.doc ";
             proc.Start();
             */

        }

        private void label4_Click(object sender, EventArgs e)
        {

        }

        private void button7_Click(object sender, EventArgs e)
        {
            openFileDialog2.Title = "Please Select a File";


            openFileDialog2.InitialDirectory = "D:\\IIDS\\IIDS\\pdfMalwareDetector";


            openFileDialog2.ShowDialog();

            textBox2.Text = openFileDialog2.FileName;
        }

        private void textBox2_TextChanged(object sender, EventArgs e)
        {

        }

        private void bunifuGradientPanel5_Paint(object sender, PaintEventArgs e)
        {

        }

        private void button4_Click(object sender, EventArgs e)
        {
            String cmd = "D:\\IIDS\\IIDS\\pdfMalwareDetector\\peepdf_0.3\\peepdf.py";
            String args = textBox2.Text;
            //String args = "E:\\pdfMalwareDetector\\pdf2.pdf";
            ProcessStartInfo start = new ProcessStartInfo();
            start.FileName = "C:\\Python27\\python";
            start.Arguments = string.Format("\"{0}\" \"{1}\"", cmd, args);
            start.UseShellExecute = false;// Do not use OS shell
            start.CreateNoWindow = true; // We don't need new window
            start.RedirectStandardOutput = true;// Any output, generated by application will be redirected back
            start.RedirectStandardError = true; // Any error in standard output will be redirected back (for example exceptions)
            using (Process process = Process.Start(start))
            {
                using (StreamReader reader = process.StandardOutput)
                {
                    string result = reader.ReadToEnd();
                    Console.Write(result);
                    
                    result=result.Substring(0,result.Length - 4);
                    char varr = result.Last();
                    Console.Write(result);
                    Console.Write(varr);
                    richTextBox1.Text = result;
                    if (!result.Contains("Suspicious"))
                        label5.Text = "Given pdf file is NON Malicious";
                    else
                        label5.Text = "Given pdf file is Malicious File";
                }
            }
        }

        private void openFileDialog2_FileOk(object sender, CancelEventArgs e)
        {

        }

        private void label5_Click(object sender, EventArgs e)
        {

        }

        private void bunifuFlatButton4_Click(object sender, EventArgs e)
        {
            bunifuGradientPanel6.Show();
            bunifuGradientPanel7.Hide();
           
        }

        private void label8_Click(object sender, EventArgs e)
        {

        }

        private void textBox4_TextChanged(object sender, EventArgs e)
        {

        }

        private void label6_Click(object sender, EventArgs e)
        {

        }

        private void button11_Click(object sender, EventArgs e)
        {
            openFileDialog3.Title = "Please Select a File";


            openFileDialog3.InitialDirectory = "E:";


            openFileDialog3.ShowDialog();

            textBox4.Text = openFileDialog3.FileName;
        }

        private void button10_Click(object sender, EventArgs e)
        {
            label6.Text = openFileDialog3.FileName;

            String cmd = "G:\\static_anaysis\\sbs1.py";
            String args = textBox4.Text;
            //String args = "E:\\pdfMalwareDetector\\pdf2.pdf";
            ProcessStartInfo start = new ProcessStartInfo();
            start.FileName = "C:\\Users\\SHAKTI\\AppData\\Local\\Programs\\Python\\Python36\\python";
            start.Arguments = string.Format("\"{0}\" \"{1}\"", cmd, args);
            start.UseShellExecute = false;// Do not use OS shell
            start.CreateNoWindow = true; // We don't need new window
            start.RedirectStandardOutput = true;// Any output, generated by application will be redirected back
            start.RedirectStandardError = true; // Any error in standard output will be redirected back (for example exceptions)
            using (Process process = Process.Start(start))
            {
                using (StreamReader reader = process.StandardOutput)
                {
                    string result = reader.ReadToEnd();
                    Console.Write(result);


                    // result = result.Substring(0, result.Length - 4);
                    char varr = result.Last();
                    Console.Write(result);
                    Console.Write(varr);
                    // richTextBox1.Text = result;
                    if (varr == '0')
                        label6.Text = "Given file is NON Malicious";
                    else
                        label6.Text = "Given  file is Malicious File";
                }

            }
        }
        private void label12_Click(object sender, EventArgs e)
        {

        }

        private void button8_Click(object sender, EventArgs e)
        {
            ProcessStartInfo startInfo = new ProcessStartInfo();
            startInfo.FileName = "C:\\Users\\SHAKTI\\Desktop\\sbs.exe";
            //startInfo.Arguments = "hook " + openFileDialog1.FileName + " D:\\IIDS\\IIDS\\Dynamic\\NewDll.dll";
            Process.Start(startInfo);

            label11.Text = "USB Protection Activated";

        }

        private void button9_Click(object sender, EventArgs e)
        {
            label11.Text = "USB Protection Deactivated";
        }

        private void bunifuFlatButton5_Click(object sender, EventArgs e)
        {
            bunifuGradientPanel7.Show();
        }
    }
}
